# Экспорт отчёта по конфигурации для MCP

## Зачем нужен отчёт?

MCP серверы используют **отчёт по конфигурации** для:
- Семантического поиска по метаданным
- Построения графа зависимостей объектов
- Понимания структуры конфигурации AI-агентами

## Для основной конфигурации

### Шаг 1: Открыть Конфигуратор

```
1. Запустить 1С:Предприятие в режиме Конфигуратор
2. Подключиться к базе данных
```

### Шаг 2: Создать отчёт

```
1. Меню: Конфигурация → Отчёты → Отчёт по конфигурации
2. В окне выбора объектов:
   - Установить галочку "Выбрать все"
   - Убедиться что выбраны все типы объектов:
     ✓ Справочники
     ✓ Документы
     ✓ Регистры
     ✓ Обработки
     ✓ Отчёты
     ✓ Общие модули
     ✓ и т.д.
3. Нажать "ОК"
```

### Шаг 3: Экспортировать

```
1. В окне отчёта нажать "Сохранить"
2. Выбрать формат: "Текстовые файлы (*.txt)"
3. Указать папку: <ProjectPath>\mcp\base\report\
4. Нажать "Сохранить"
```

### Результат

```
mcp/base/report/
├── Справочники.txt
├── Документы.txt
├── РегистрыСведений.txt
├── ОбщиеМодули.txt
└── ... (другие файлы)
```

---

## Для расширения

### Шаг 1: Открыть Конфигуратор

```
1. Запустить 1С:Предприятие в режиме Конфигуратор
2. Подключиться к базе данных
```

### Шаг 2: Выбрать расширение

```
1. Меню: Конфигурация → Расширения конфигурации
2. Выбрать нужное расширение из списка
3. Двойной клик для открытия
```

### Шаг 3: Создать отчёт

```
1. В контекстном меню расширения:
   Отчёты → Отчёт по конфигурации
2. Выбрать все объекты расширения
3. Нажать "ОК"
```

### Шаг 4: Экспортировать

```
1. В окне отчёта нажать "Сохранить"
2. Выбрать формат: "Текстовые файлы (*.txt)"
3. Указать папку: <ProjectPath>\mcp\ext\report\
4. Нажать "Сохранить"
```

### Результат

```
mcp/ext/report/
├── Справочники.txt
├── Документы.txt
└── ... (объекты расширения)
```

---

## Важные замечания

### Размер файлов
- Отчёты могут быть большими (10-100 МБ)
- Не коммитить в Git (уже в .gitignore)
- Обновлять после изменений метаданных

### Кодировка
- 1С экспортирует в Windows-1251
- MCP серверы автоматически конвертируют в UTF-8
- Не нужно ручное преобразование

### Частота обновления
- После добавления новых объектов
- После изменения структуры метаданных
- После обновления конфигурации
- Не нужно при изменении только кода модулей

### Альтернатива
Если отчёт не нужен (только поиск по коду):
- Можно не экспортировать report/
- MCP будет работать только с src/ (код)
- Но без семантического поиска по метаданным

---

## Проверка

После экспорта проверьте:

```powershell
# Проверить наличие файлов
ls mcp\base\report\

# Проверить размер (должно быть >1 МБ)
(Get-ChildItem mcp\base\report\ -Recurse | Measure-Object -Property Length -Sum).Sum / 1MB
```

Ожидаемый результат:
- 10+ файлов *.txt
- Общий размер 5-50 МБ (зависит от размера конфигурации)

---

## Следующие шаги

После экспорта отчёта:
1. Убедитесь что symlink `mcp/base/src` указывает на `src/cf/`
2. Следуйте инструкциям в `configs/mcp-setup.md`
3. Разверните MCP серверы на Docker LXC
4. Дождитесь завершения индексации (~40-60 минут)
